-- ===============================
-- PHARMACII HUB LOADER (Xeno)
-- ===============================

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer
if not player then return end

local SAVE_FILE = "pharmacii_key.json"

-- Load / Save Key
local function saveKey(key)
    if writefile then
        pcall(function()
            writefile(SAVE_FILE, HttpService:JSONEncode({key = key}))
        end)
    end
end

local function loadKey()
    if readfile and isfile and isfile(SAVE_FILE) then
        local ok, data = pcall(function()
            return HttpService:JSONDecode(readfile(SAVE_FILE)).key
        end)
        if ok and data then return data end
    end
    return ""
end

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = "PharmaciiHubLoader"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.fromScale(0.36,0.34)
frame.Position = UDim2.fromScale(0.5,0.5)
frame.AnchorPoint = Vector2.new(0.5,0.5)
frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
frame.BorderSizePixel = 0
Instance.new("UICorner", frame).CornerRadius = UDim.new(0,14)
frame.Parent = gui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0.25,0)
title.BackgroundTransparency = 1
title.Text = "PHARMACII HUB"
title.Font = Enum.Font.GothamBold
title.TextSize = 24
title.TextColor3 = Color3.fromRGB(255,90,90)
title.Parent = frame

local box = Instance.new("TextBox")
box.Size = UDim2.fromScale(0.8,0.2)
box.Position = UDim2.fromScale(0.1,0.42)
box.PlaceholderText = "Enter Key"
box.Font = Enum.Font.Gotham
box.TextSize = 16
box.TextColor3 = Color3.fromRGB(255,255,255)
box.BackgroundColor3 = Color3.fromRGB(50,50,50)
Instance.new("UICorner", box).CornerRadius = UDim.new(0,8)
box.Text = loadKey()
box.Parent = frame

local loadBtn = Instance.new("TextButton")
loadBtn.Size = UDim2.fromScale(0.38,0.18)
loadBtn.Position = UDim2.fromScale(0.31,0.72)
loadBtn.Text = "LOAD"
loadBtn.Font = Enum.Font.GothamBold
loadBtn.TextSize = 16
loadBtn.TextColor3 = Color3.new(1,1,1)
loadBtn.BackgroundColor3 = Color3.fromRGB(255,70,70)
Instance.new("UICorner", loadBtn).CornerRadius = UDim.new(1,0)
loadBtn.Parent = frame

local glow = Instance.new("UIStroke", loadBtn)
glow.Color = Color3.fromRGB(255,110,110)
glow.Thickness = 2
glow.Transparency = 0.2

-- Fade Out Function
local function fadeOut()
    TweenService:Create(frame, TweenInfo.new(0.4), {BackgroundTransparency = 1}):Play()
    task.wait(0.35)
    gui:Destroy()
end

-- Load Button Logic
loadBtn.MouseButton1Click:Connect(function()
    if box.Text == "" then return end
    saveKey(box.Text)
    fadeOut()

    -- Load main hub safely
    local success, library = pcall(function()
        return loadstring(game:HttpGet("https://raw.githubusercontent.com/GoHamza/AppleLibrary/main/main.lua"))()
    end)

    if success and library then
        local window = library:init(
            "Pharmacii Hub",
            true,
            Enum.KeyCode.RightShift,
            true
        )
        print("Pharmacii Hub loaded successfully âœ…")
    else
        warn("Failed to load main library")
    end
end)
